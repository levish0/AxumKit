# =============================================================================
# AxumKit Server
# =============================================================================
axumkit-server:
  enabled: true

  config:
    ENVIRONMENT: "prod"
    HOST: "0.0.0.0"
    PORT: "8000"
    RUST_LOG: "info"

    AUTH_SESSION_MAX_LIFETIME_HOURS: "720"
    AUTH_SESSION_SLIDING_TTL_HOURS: "24"
    AUTH_SESSION_REFRESH_THRESHOLD: "50"

    REDIS_SESSION_HOST: "axumkit-redis-session-master"
    REDIS_SESSION_PORT: "6379"
    REDIS_CACHE_HOST: "axumkit-redis-cache-master"
    REDIS_CACHE_PORT: "6379"
    REDIS_CACHE_TTL: "3600"

    MEILISEARCH_HOST: "http://axumkit-meilisearch:7700"

  secret:
    TOTP_SECRET: ""

    POSTGRES_WRITE_HOST: "axumkit-postgresql"
    POSTGRES_WRITE_PORT: "5432"
    POSTGRES_WRITE_NAME: "axumkit"
    POSTGRES_WRITE_USER: "axumkit"
    POSTGRES_WRITE_PASSWORD: ""

    POSTGRES_READ_HOST: "axumkit-postgresql"
    POSTGRES_READ_PORT: "5432"
    POSTGRES_READ_NAME: "axumkit"
    POSTGRES_READ_USER: "axumkit"
    POSTGRES_READ_PASSWORD: ""

    NATS_URL: "nats://axumkit-nats:4222"
    SEAWEEDFS_ENDPOINT: "http://axumkit-seaweedfs-filer:8888"

    GOOGLE_CLIENT_ID: ""
    GOOGLE_CLIENT_SECRET: ""
    GOOGLE_REDIRECT_URI: ""

    GITHUB_CLIENT_ID: ""
    GITHUB_CLIENT_SECRET: ""
    GITHUB_REDIRECT_URI: ""

    R2_ENDPOINT: ""
    R2_REGION: "auto"
    R2_PUBLIC_DOMAIN: ""
    R2_BUCKET_NAME: ""
    R2_ACCESS_KEY_ID: ""
    R2_SECRET_ACCESS_KEY: ""

    TURNSTILE_SECRET_KEY: ""
    MEILISEARCH_API_KEY: ""

# =============================================================================
# AxumKit Worker
# =============================================================================
axumkit-worker:
  enabled: true

  config:
    RUST_LOG: "info"
    MEILISEARCH_HOST: "http://axumkit-meilisearch:7700"
    REDIS_CACHE_HOST: "axumkit-redis-cache-master"
    REDIS_CACHE_PORT: "6379"
    FRONTEND_HOST: ""
    PROJECT_NAME: "AxumKit"
    FRONTEND_PATH_VERIFY_EMAIL: "/verify-email"
    FRONTEND_PATH_RESET_PASSWORD: "/reset-password"
    FRONTEND_PATH_CONFIRM_EMAIL_CHANGE: "/confirm-email-change"
    CRON_TIMEZONE: "UTC"

  secret:
    SMTP_HOST: ""
    SMTP_PORT: "587"
    SMTP_USER: ""
    SMTP_PASSWORD: ""
    SMTP_TLS: "true"
    EMAILS_FROM_EMAIL: ""
    EMAILS_FROM_NAME: "AxumKit"

    POSTGRES_WRITE_HOST: "axumkit-postgresql"
    POSTGRES_WRITE_PORT: "5432"
    POSTGRES_WRITE_NAME: "axumkit"
    POSTGRES_WRITE_USER: "axumkit"
    POSTGRES_WRITE_PASSWORD: ""

    NATS_URL: "nats://axumkit-nats:4222"
    SEAWEEDFS_ENDPOINT: "http://axumkit-seaweedfs-filer:8888"

    R2_ENDPOINT: ""
    R2_REGION: "auto"
    R2_PUBLIC_DOMAIN: ""
    R2_BUCKET_NAME: ""
    R2_ACCESS_KEY_ID: ""
    R2_SECRET_ACCESS_KEY: ""

    MEILISEARCH_API_KEY: ""

# =============================================================================
# PostgreSQL (Bitnami)
# =============================================================================
postgresql:
  enabled: true

  auth:
    database: axumkit
    username: axumkit
    password: ""  # Set in values-local.yaml

  primary:
    persistence:
      size: 10Gi

# =============================================================================
# Redis Session (Bitnami)
# =============================================================================
redis-session:
  enabled: true

  architecture: standalone

  auth:
    enabled: false

  master:
    persistence:
      size: 1Gi
    resources:
      limits:
        memory: 512Mi

# =============================================================================
# Redis Cache (Bitnami)
# =============================================================================
redis-cache:
  enabled: true

  architecture: standalone

  auth:
    enabled: false

  master:
    persistence:
      enabled: false
    resources:
      limits:
        memory: 1Gi
    extraFlags:
      - "--maxmemory 900mb"
      - "--maxmemory-policy allkeys-lru"

# =============================================================================
# NATS
# =============================================================================
nats:
  enabled: true

  config:
    jetstream:
      enabled: true
      fileStore:
        pvc:
          size: 5Gi

# =============================================================================
# MeiliSearch
# =============================================================================
meilisearch:
  enabled: true

  environment:
    MEILI_ENV: production

  persistence:
    enabled: true
    size: 10Gi

# =============================================================================
# SeaweedFS
# =============================================================================
seaweedfs:
  enabled: true

  master:
    replicas: 1
    storage: 1Gi

  volume:
    replicas: 1
    storage: 50Gi

  filer:
    replicas: 1
    storage: 1Gi
    s3:
      enabled: true
